!function(){"use strict";var e={691:function(e,t,n){t.__esModule=!0;var r=n(525),o=n(966),i="badge badge-pill badge-";r.default.component("bond-row",{props:["row"],template:"#bond-row-template",computed:{moexUrl:function(){return"https://www.moex.com/ru/issue.aspx?code="+this.row.isin},ratingText:function(){return(0,o.ratingText)(this.row)},listLevelBadgeClass:function(){var e=this.row;switch(e.listLevel){case 1:return i+"success";case 2:return i+"warning";case 3:return e.isHighRisk?i+"dark bond-finder-ir-badge":i+"danger"}},listLevelName:function(){var e=this.row;switch(e.listLevel){case 1:return"I";case 2:return"II";case 3:return e.isHighRisk?" ":"III"}},showCouponStar:function(){return(0,o.isVarCoupon)(this.row)||(0,o.hasOffer)(this.row)},rowClass:function(){return this.row.infoUrl?"bond-finder-separator":null}}})},871:function(e,t,n){t.__esModule=!0;var r=n(403),o="https://bond-finder-lab.github.io/backend/report-v1.json?_="+Date.now(),i="report-cache-v1";t.default=function(e){var t=new XMLHttpRequest;function n(t){try{e(function(e){for(var t=e.cols,n=e.rows,r={},o=0,i=t;o<i.length;o++){var a=i[o];r[a]=t.indexOf(a)}return{date:String(e.date),rows:n.map((function(e){return{isin:String(e[r.isin]),name:String(e[r.name]),sector:Number(e[r.sector]),listLevel:Number(e[r.list_level]),totalTradesPerc:Number(e[r.total_trades_perc]),maturityDate:String(e[r.maturity_date]),minDaysBetweenAmort:Number(e[r.min_days_between_amort]),couponMonths:e[r.coupon_months],couponValues:e[r.coupon_values],closeYield:Number(e[r.close_yield]),inABI:Boolean(e[r.in_abi]),inCBHY:Boolean(e[r.in_cbhy]),isHighRisk:Boolean(e[r.high_risk]),isQualOnly:Boolean(e[r.qual]),rub:!("rub"in r)||Boolean(e[r.rub]),rating:Number(e[r.rating]),waprice:Number(e[r.waprice]),fits:!1,top:!1,infoUrl:null}}))}}(JSON.parse(t)))}catch(t){e({error:!0,date:null,rows:[]})}}t.open("GET",o,!0),t.timeout=1e4,t.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){var e=this.responseText;r.default.save(i,e),n(e)}else n(r.default.load(i))},t.send()}},829:function(e,t,n){t.__esModule=!0;var r,o,i=n(403),a="night",u=!1;function s(){return r<0?function(){try{return window.matchMedia&&matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}():r>0}function c(e,t,n){var r=e.classList;n?r.add(t):r.remove(t)}function l(){c(document.documentElement,"night",s())}o=i.default.load(a),r=null==o?-1:Number(o),document.addEventListener("scroll",(function(){var e=window.pageYOffset>0;u!==e&&(c(document.documentElement,"scrolled",e),u=e)}),!1),t.default={getMode:function(){return r},setMode:function(e){r=e,i.default.save(a,e),l()},updateMarkup:l}},966:function(e,t){function n(e){return r(e,"ПК")}function r(e,t){return 1===e.sector&&e.name.substr(0,7)==="ОФЗ-".concat(t," ")}function o(e){return e.couponValues.length>1||n(e)}function i(e){var t=e.couponValues;return null===t[t.length-1]&&!n(e)}function a(e){switch(e.rating){case 6:return"AAA";case 5.1:return"AA+";case 5:return"AA";case 4.9:return"AA-";case 4.1:return"A+";case 4:return"A";case 3.9:return"A-";case 3.1:return"BBB+";case 3:return"BBB";case 2.9:return"BBB-";case 2.1:return"BB+";case 2:return"BB";case 1.9:return"BB-";case 1.1:return"B+";case 1:return"B";case.9:return"B-"}return""}t.__esModule=!0,t.toTsvLine=t.ratingText=t.hasOffer=t.isVarCoupon=t.isOFZ=void 0,t.isOFZ=r,t.isVarCoupon=o,t.hasOffer=i,t.ratingText=a,t.toTsvLine=function(e){function t(e){return n(String(e||""),8,!0)}function n(e,t,n){for(void 0===n&&(n=!1);e.length<t;)n?e=" "+e:e+=" ";return e}return[e.isin,n(e.name,12),function(){var t=[];e.isQualOnly?t.push("кв"):e.inABI?t.push("*"):e.inCBHY&&t.push("вд");e.isHighRisk&&t.push("пир");return n(t.join(", "),7)}(),e.listLevel,n(a(e),4),e.maturityDate,t(e.waprice),function(){if(o(e)||i(e))return"**";return""}(),t(e.couponValues[0]),t(e.closeYield)].join("\t")}},310:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.save=t.load=void 0;var o=n(403),i="settings-v1",a=new Date,u=new Date(a.getFullYear()+1,a.getMonth(),1),s=new Date(a.getFullYear()+4,a.getMonth(),1);function c(e){var t=1+e.getMonth();return t>9?String(t):"0"+t}var l={rub:!0,min_month:c(u),month:c(s),min_year:String(u.getFullYear()),year:String(s.getFullYear()),sector1:!0,sector2:!0,sector3:!0,highRisk:!0,maxListLevel:"2",minRating:"0",minRatingMod:"0",maxPerYear:"4",requiredCouponMonth:"0",couponType:"0",maxAmort:"90",minTotalTradesPerc:"50"};t.load=function(){var e=r({},l),t=o.default.load(i,!0);if(t&&"object"==typeof t)for(var n=0,a=Object.keys(l);n<a.length;n++){var u=a[n];u in t&&(e[u]=t[u])}return e},t.save=function(e){o.default.save(i,e,!0)}},403:function(e,t){function n(e){return"bond-finder-"+e}t.__esModule=!0,t.default={load:function(e,t){void 0===t&&(t=!1);try{var r=localStorage.getItem(n(e));return t?JSON.parse(r):r}catch(e){return null}},save:function(e,t,r){void 0===r&&(r=!1);try{localStorage.setItem(n(e),(r?JSON.stringify:String)(t))}catch(e){}}}},525:function(e){e.exports={default:Vue}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}!function(){var e=n(525);n(691);var t=n(871),r=n(829),o=n(966),i=n(310),a=n(403),u=Date.now(),s="vue-root",c=window.cordova,l={nightMode:r.default.getMode(),collapseForm:window.matchMedia&&window.matchMedia("(max-width: 992px)").matches};function f(){(0,i.save)(l.settings);for(var e=l.settings,t=e.rub,n=[h(e.min_year),e.min_month,"01"].join("-"),r=[h(e.year),e.month,"31"].join("-"),a=Number(e.maxListLevel),u=Number(e.minRating),s=Number(e.minRatingMod),c=Number(e.maxPerYear),f=Number(e.requiredCouponMonth),d=Number(e.maxAmort),p=Number(e.minTotalTradesPerc),g=Number(e.couponType),v=g>0,w=g>1,b=m(u)?u+s:u,y=0,B=!1,x=!1,k=!1,M=!1,_=!1,O=!1,N=!1,A=!1,C=0,L=l.reportRows;C<L.length;C++){var S=L[C];if(R(S)?(y++,S.fits=!0,S.top=y<=20,_=_||(0,o.isVarCoupon)(S),O=O||(0,o.hasOffer)(S),B=B||S.inABI,x=x||S.inCBHY,k=k||S.isHighRisk,M=M||S.isQualOnly,S.infoUrl=null,S.closeYield||(!N&&(0,o.isOFZ)(S,"ПК")?(N=!0,S.infoUrl="https://bcs-express.ru/novosti-i-analitika/ofz-pk-s-priviazkoi-k-ruonia-kak-zashchitit-sredstva-ot-infliatsii"):!A&&(0,o.isOFZ)(S,"ИН")&&(A=!0,S.infoUrl="https://bcs-express.ru/novosti-i-analitika/ofz-in-ili-kak-garantirovano-zashchitit-sebia-ot-infliatsii"))):S.fits=S.top=!1,y>=1e3)break}function R(i){if(i.rub!==t)return!1;if(t&&i.isHighRisk&&!e.highRisk)return!1;if(n.length<10||r.length<10)return!1;if(i.maturityDate<n||i.maturityDate>r)return!1;if(t){if(e.sector1||e.sector2||e.sector3){if(1===i.sector&&!e.sector1)return!1;if(2===i.sector&&!e.sector2)return!1;if(3===i.sector&&!e.sector3)return!1}if(i.listLevel>a)return!1;if(i.rating<b)return!1;if(c>-1){if(-12===i.couponMonths[0])return!1;if(i.couponMonths.length>c)return!1}}if(f>0&&i.couponMonths.indexOf(f)<0)return!1;if(!v&&(0,o.isVarCoupon)(i))return!1;if(!w&&(0,o.hasOffer)(i))return!1;if(t&&i.minDaysBetweenAmort>0){if(-1===d)return!1;if(i.minDaysBetweenAmort<d)return!1}return!(i.totalTradesPerc<p)}l.totalFits=y,l.showAll=y/20<1.5,l.hasABI=B,l.hasCBHY=x,l.hasHighRisk=k,l.hasQualOnly=M,l.showVarCouponNotice=_,l.showOfferNotice=O,l.showClipboardCheck=!1}function d(){Date.now()-u>1234e3&&location.reload()}function h(e){return(e=String(e)).length<4?"2000":e.length>4?"3000":e}function m(e){return e>0&&e<6}function p(){for(var e=[],t=0,n=l.reportRows;t<n.length;t++){var r=n[t];r.fits&&e.push((0,o.toTsvLine)(r))}var i=e.join("\n");function a(){c||(l.showClipboardCheck=!0)}function u(){alert("Не получилось")}if(c)c.exec(a,u,"CordovaPluginUtils","clipboardWrite",[i]);else try{navigator.clipboard.writeText(i).then(a,u)}catch(e){u()}}r.default.updateMarkup(),c&&(document.addEventListener("deviceready",(function(){document.addEventListener("resume",d,!1)}),!1),document.addEventListener("deviceconfigchange",(function(){r.default.updateMarkup()}),!1),document.addEventListener("click",(function(e){var t=e.target;"A"!==t.tagName||function(e){if(!e)return!0;var t=e.indexOf("moex.com/")>-1?"moex":"other",n="confirm-external-link-"+t;if(!a.default.load(n)){if(!confirm("Пожалуйста, подтвердите переход на "+("moex"===t?"сайт Московской Биржи":"внешний сайт")))return!1;a.default.save(n,"1")}return!0}(t.href)||(e.preventDefault(),e.stopPropagation())}),!1)),(0,t.default)((function(t){l.settings=(0,i.load)(),l.reportDate=t.date,l.reportRows=t.rows;var n,o=t.error;l.reportError=o,f(),new e.default({el:"#"+s,data:l,watch:{nightMode:{handler:function(e){return r.default.setMode(e)}},settings:{deep:!0,handler:function(){return f()}}},methods:{alertClose:function(){return a.default.save("alert-v1",!0)},clipboardButtonClick:p},computed:{minRatingModVisible:function(){return m(Number(this.settings.minRating))}}}),document.getElementById(s).style.display="",document.getElementById("bond-finder-loading").style.display="none",c||((n=document.documentElement).style.fontSize="medium",n.style.fontSize=1600/parseFloat(getComputedStyle(n).fontSize)+"%")}))}()}();
//# sourceMappingURL=index.js.map